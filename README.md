# ä»é›¶åˆ°ä¸€ï¼šæ„å»ºç°ä»£åŒ–çš„ FastAPI + LangGraph å¯¹è¯ç³»ç»Ÿ

> ä¸€ä¸ªé›†æˆäº†ç”¨æˆ·è®¤è¯ã€LangGraph å¯¹è¯ç³»ç»Ÿã€å®Œæ•´æµ‹è¯•å’Œä»£ç è´¨é‡ä¿è¯çš„ FastAPI åç«¯æ¨¡æ¿é¡¹ç›®

## ğŸ“– é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº FastAPI + SQLAlchemy 2.0 + LangGraph çš„ç°ä»£åŒ–åç«¯é¡¹ç›®æ¨¡æ¿ã€‚å®ƒä¸ä»…æä¾›äº†å®Œæ•´çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼Œè¿˜é›†æˆäº† LangGraph å¯¹è¯ç³»ç»Ÿï¼Œæ”¯æŒä¼šè¯ç®¡ç†ã€çŠ¶æ€æŒä¹…åŒ–ã€æ¶ˆæ¯å†å²ç­‰åŠŸèƒ½ã€‚é¡¹ç›®é‡‡ç”¨å¼‚æ­¥ç¼–ç¨‹èŒƒå¼ï¼Œéµå¾ªæœ€ä½³å®è·µï¼ŒåŒ…å«å®Œæ•´çš„æµ‹è¯•è¦†ç›–å’Œä»£ç è´¨é‡ä¿è¯å·¥å…·ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸš€ **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**ï¼šFastAPI + SQLAlchemy 2.0 + LangGraph + Pydantic v2
- ğŸ” **å®Œæ•´çš„è®¤è¯ç³»ç»Ÿ**ï¼šJWT åŒä»¤ç‰Œã€å¯†ç åŠ å¯†ã€èµ„æ–™æ›´æ–°ã€å¯†ç é‡ç½®
- ğŸ§‘â€ğŸ’¼ **ç”¨æˆ·ä¸ªæ€§åŒ–è®¾ç½®**ï¼šå†…ç½® `UserSettings`ï¼Œæ”¯æŒé»˜è®¤æ¨¡å‹/æ¸©åº¦/Tokenã€ä¸»é¢˜ã€è¯­è¨€ç­‰åå¥½
- ğŸ’¬ **LangGraph å¯¹è¯ç³»ç»Ÿ**ï¼šæµå¼/éæµå¼å¯¹è¯ã€çŠ¶æ€æŒä¹…åŒ–ã€æ£€æŸ¥ç‚¹ã€æ¶ˆæ¯å†ç”Ÿæˆä¸é‡ç½®
- ğŸ—‚ï¸ **ä¼šè¯è¿è¥å·¥å…·**ï¼šä¼šè¯ CRUDã€æ¶ˆæ¯å†å²ã€å¯¼å‡º/å¯¼å…¥ã€å…¨æ–‡æœç´¢ã€ç”¨æˆ·çº§ç»Ÿè®¡
- ğŸ“Š **æ•°æ®åº“ç®¡ç†**ï¼šAlembic è¿ç§»ã€å¼‚æ­¥ ORMã€è¿æ¥æ± ç®¡ç†
- ğŸ§ª **æµ‹è¯•è¦†ç›–**ï¼šé›†æˆæµ‹è¯•ã€å•å…ƒæµ‹è¯•ã€æµ‹è¯•è¦†ç›–ç‡
- ğŸ” **ä»£ç è´¨é‡**ï¼šRuffã€MyPyã€Pre-commit é’©å­
- ğŸ“ **ç»“æ„åŒ–æ—¥å¿—**ï¼šLoguru æ—¥å¿—ç³»ç»Ÿã€è¯·æ±‚è¿½è¸ª

## ğŸ¯ é€‚ç”¨åœºæ™¯

è¿™ä¸ªæ¨¡æ¿é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š

- å¿«é€Ÿå¯åŠ¨ FastAPI é¡¹ç›®ï¼Œæ— éœ€ä»é›¶é…ç½®
- æ„å»ºéœ€è¦ç”¨æˆ·è®¤è¯çš„ Web API æœåŠ¡
- å¼€å‘åŸºäº LangGraph çš„å¯¹è¯/èŠå¤©åº”ç”¨
- å­¦ä¹  FastAPI å’Œå¼‚æ­¥ç¼–ç¨‹æœ€ä½³å®è·µ
- ä½œä¸ºä¼ä¸šçº§é¡¹ç›®çš„èµ·ç‚¹æ¨¡æ¿

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| FastAPI | 0.121+ | ç°ä»£åŒ– Web æ¡†æ¶ |
| SQLAlchemy | 2.0+ | å¼‚æ­¥ ORM |
| LangGraph | 1.0+ | å¯¹è¯æµç¨‹ç¼–æ’ |
| LangChain | 1.0+ | LLM åº”ç”¨å¼€å‘ |
| Pydantic | 2.12+ | æ•°æ®éªŒè¯ |
| Alembic | 1.17+ | æ•°æ®åº“è¿ç§» |
| Loguru | 0.7+ | æ—¥å¿—ç³»ç»Ÿ |
| Ruff | 0.14+ | ä»£ç æ£€æŸ¥ |
| MyPy | 1.18+ | ç±»å‹æ£€æŸ¥ |

### é¡¹ç›®ç»“æ„

```
fastapi-template/
â”œâ”€â”€ app/                          # åº”ç”¨æ ¸å¿ƒä»£ç 
â”‚   â”œâ”€â”€ api/                      # API è·¯ç”±å±‚
â”‚   â”‚   â”œâ”€â”€ users.py              # ç”¨æˆ·ç®¡ç† API
â”‚   â”‚   â”œâ”€â”€ chat.py               # å¯¹è¯ API (LangGraph)
â”‚   â”‚   â””â”€â”€ conversations.py     # ä¼šè¯ç®¡ç† API
â”‚   â”œâ”€â”€ core/                     # æ ¸å¿ƒé…ç½®æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ config.py             # é…ç½®ç®¡ç† (ç¯å¢ƒå˜é‡)
â”‚   â”‚   â”œâ”€â”€ database.py           # æ•°æ®åº“è¿æ¥å’Œä¼šè¯ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ deps.py               # ä¾èµ–æ³¨å…¥ (è®¤è¯ã€æƒé™ç­‰)
â”‚   â”‚   â”œâ”€â”€ lifespan.py           # åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â”‚   â”œâ”€â”€ security.py           # JWT è®¤è¯å’Œå¯†ç åŠ å¯†
â”‚   â”‚   â”œâ”€â”€ graph.py              # LangGraph å›¾å®šä¹‰
â”‚   â”‚   â””â”€â”€ checkpointer.py       # LangGraph æ£€æŸ¥ç‚¹ç®¡ç†
â”‚   â”œâ”€â”€ middleware/               # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ logging.py            # è¯·æ±‚æ—¥å¿—ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ models/                   # SQLAlchemy æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ base.py               # åŸºç¡€æ¨¡å‹å’Œ Mixin
â”‚   â”‚   â”œâ”€â”€ user.py               # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ conversation.py       # ä¼šè¯æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ message.py            # æ¶ˆæ¯æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ execution_log.py      # æ‰§è¡Œæ—¥å¿—æ¨¡å‹
â”‚   â”‚   â””â”€â”€ user_settings.py      # ç”¨æˆ·ä¸ªæ€§åŒ–è®¾ç½®
â”‚   â”œâ”€â”€ schemas/                  # Pydantic æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.py               # ç”¨æˆ· Schema
â”‚   â”‚   â”œâ”€â”€ chat.py               # å¯¹è¯ Schema
â”‚   â”‚   â”œâ”€â”€ conversation.py       # ä¼šè¯ Schema
â”‚   â”‚   â””â”€â”€ user_settings.py      # ç”¨æˆ·è®¾ç½® Schema
â”‚   â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ datetime.py           # æ—¥æœŸæ—¶é—´å·¥å…·
â”‚   â”œâ”€â”€ sample_agent.py           # LangGraph ç¤ºä¾‹ Agent
â”‚   â””â”€â”€ main.py                   # åº”ç”¨å…¥å£å’Œè·¯ç”±æ³¨å†Œ
â”œâ”€â”€ alembic/                      # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ versions/                 # è¿ç§»è„šæœ¬ç‰ˆæœ¬
â”‚   â””â”€â”€ env.py                    # Alembic é…ç½®
â”œâ”€â”€ scripts/                      # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ create_superuser.py       # åˆ›å»ºè¶…çº§ç®¡ç†å‘˜
â”‚   â””â”€â”€ init_db.py                # åˆå§‹åŒ–æ•°æ®åº“
â”œâ”€â”€ tests/                        # æµ‹è¯•ä»£ç 
â”‚   â”œâ”€â”€ integration/              # é›†æˆæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_user_route.py    # ç”¨æˆ· API æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_chat_route.py    # å¯¹è¯ API æµ‹è¯•
â”‚   â”‚   â””â”€â”€ test_conversations_route.py  # ä¼šè¯ API æµ‹è¯•
â”‚   â””â”€â”€ conftest.py               # Pytest é…ç½®
â”œâ”€â”€ docs/                         # æ–‡æ¡£
â”‚   â””â”€â”€ AsyncSqliteSaverå·¥ä½œåŸç†.md  # LangGraph æ£€æŸ¥ç‚¹åŸç†
â”œâ”€â”€ logs/                         # æ—¥å¿—ç›®å½•
â”œâ”€â”€ .env                          # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ pyproject.toml                # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ Makefile                      # å¸¸ç”¨å‘½ä»¤é›†åˆ
â””â”€â”€ README.md                     # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.12+
- uvï¼ˆæ¨èçš„ Python åŒ…ç®¡ç†å™¨ï¼‰

### 2. å®‰è£…ä¾èµ–

```bash
# å®‰è£… uvï¼ˆå¦‚æœå°šæœªå®‰è£…ï¼‰
curl -LsSf https://astral.sh/uv/install.sh | sh

# å…‹éš†é¡¹ç›®
git clone https://github.com/zhajiahe/fastapi-template.git
cd fastapi-template

# å®‰è£…ä¾èµ–
uv sync
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# æ•°æ®åº“é…ç½®
DATABASE_URL=sqlite+aiosqlite:///./langgraph_app.db

# JWT é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä¿®æ”¹ï¼‰
SECRET_KEY=your-secret-key-change-in-production
REFRESH_SECRET_KEY=your-refresh-secret-key-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# åº”ç”¨é…ç½®
APP_NAME=FastAPI-Template
DEBUG=true

# LangGraph é…ç½®
CHECKPOINT_DB_PATH=./langgraph_app.db

# LangChain / SiliconFlow ç¤ºä¾‹é…ç½®
SILICONFLOW_API_KEY=your-api-key
SILICONFLOW_API_BASE=https://api.siliconflow.cn/v1
SILICONFLOW_LLM_MODEL=Qwen/Qwen3-8B
```

### 4. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ä½¿ç”¨ Makefile
make db-upgrade

# æˆ–ç›´æ¥ä½¿ç”¨ Alembic
uv run alembic upgrade head
```

### 5. åˆ›å»ºè¶…çº§ç®¡ç†å‘˜

```bash
uv run python scripts/create_superuser.py
```

### 6. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# ä½¿ç”¨ Makefile
make dev

# æˆ–ç›´æ¥ä½¿ç”¨ uvicorn
uv run uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

è®¿é—® http://localhost:8000/docs æŸ¥çœ‹äº¤äº’å¼ API æ–‡æ¡£ã€‚

## ğŸ’¡ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

é¡¹ç›®å®ç°äº†å®Œæ•´çš„ç”¨æˆ·è®¤è¯å’Œæˆæƒç³»ç»Ÿï¼š

- **ç”¨æˆ·æ³¨å†Œä¸ç™»å½•**ï¼šæ”¯æŒç”¨æˆ·å/é‚®ç®±æ³¨å†Œï¼ŒJWT ä»¤ç‰Œè®¤è¯
- **åŒä»¤ç‰Œæœºåˆ¶**ï¼šAccess Tokenï¼ˆçŸ­æœŸï¼‰å’Œ Refresh Tokenï¼ˆé•¿æœŸï¼‰
- **å¯†ç å®‰å…¨**ï¼šä½¿ç”¨ Bcrypt è¿›è¡Œå¯†ç åŠ å¯†
- **æƒé™ç®¡ç†**ï¼šæ”¯æŒæ™®é€šç”¨æˆ·å’Œè¶…çº§ç®¡ç†å‘˜è§’è‰²
- **ç”¨æˆ·ä¿¡æ¯ç®¡ç†**ï¼šè·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ã€ä¿®æ”¹å¯†ç ç­‰

### 2. LangGraph å¯¹è¯ç³»ç»Ÿ

é›†æˆäº† LangGraph å¯¹è¯æµç¨‹ç¼–æ’ç³»ç»Ÿï¼š

- **å¼‚æ­¥å¯¹è¯æ¥å£**ï¼šæ”¯æŒéæµå¼å“åº”ä¸ SSE æµå¼è¾“å‡º
- **ä¼šè¯ç”Ÿå‘½å‘¨æœŸ**ï¼šåˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ã€é‡ç½®ã€ç¡¬åˆ é™¤
- **æ¶ˆæ¯æ“ä½œ**ï¼šå®Œæ•´çš„æ¶ˆæ¯å†å²ï¼Œå¹¶æ”¯æŒé‡æ–°ç”ŸæˆæŒ‡å®šåŠ©æ‰‹å›å¤
- **çŠ¶æ€æŒä¹…åŒ–**ï¼šä½¿ç”¨ AsyncSqliteSaver ä¿ç•™å›¾çŠ¶æ€ï¼Œéšæ—¶æ¢å¤
- **æ£€æŸ¥ç‚¹ç®¡ç†**ï¼šæŸ¥çœ‹å†å²æ£€æŸ¥ç‚¹ï¼Œæ”¯æŒæ—¶é—´æ—…è¡Œèƒ½åŠ›
- **ä¼šè¯å¯¼å‡º/å¯¼å…¥**ï¼šä¸€é”®å¯¼å‡ºå¯¹è¯ã€æ¶ˆæ¯ä¸çŠ¶æ€å¹¶å¯å¯¼å…¥æ¢å¤
- **å…¨æ–‡æœç´¢**ï¼šåœ¨å½“å‰ç”¨æˆ·èŒƒå›´å†…æœç´¢æ¶ˆæ¯å†…å®¹
- **ç”¨æˆ·ç»Ÿè®¡**ï¼šè·å–ä¼šè¯ / æ¶ˆæ¯æ•°é‡ä¸æœ€è¿‘ä¼šè¯æ¦‚è§ˆ

### 3. æ•°æ®åº“å±‚

é‡‡ç”¨ SQLAlchemy 2.0+ å¼‚æ­¥ ORMï¼š

- **å¼‚æ­¥æ“ä½œ**ï¼šæ‰€æœ‰æ•°æ®åº“æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä¸é˜»å¡äº‹ä»¶å¾ªç¯
- **è¿æ¥æ± ç®¡ç†**ï¼šè‡ªåŠ¨ç®¡ç†æ•°æ®åº“è¿æ¥æ± 
- **äº‹åŠ¡ç®¡ç†**ï¼šè‡ªåŠ¨å¤„ç†äº‹åŠ¡æäº¤å’Œå›æ»š
- **é€šç”¨åŸºç¡€æ¨¡å‹**ï¼šåŒ…å« IDã€åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€é€»è¾‘åˆ é™¤ç­‰é€šç”¨å­—æ®µ
- **æ•°æ®åº“è¿ç§»**ï¼šä½¿ç”¨ Alembic è¿›è¡Œç‰ˆæœ¬åŒ–æ•°æ®åº“è¿ç§»

### 4. ä»£ç è´¨é‡ä¿è¯

é¡¹ç›®é›†æˆäº†å®Œæ•´çš„ä»£ç è´¨é‡å·¥å…·é“¾ï¼š

- **Ruff**ï¼šå¿«é€Ÿçš„ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–å·¥å…·
- **MyPy**ï¼šé™æ€ç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿ç±»å‹å®‰å…¨
- **Pytest**ï¼šå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•æ¡†æ¶
- **Pre-commit**ï¼šGit æäº¤å‰è‡ªåŠ¨è¿è¡Œæ£€æŸ¥
- **æµ‹è¯•è¦†ç›–ç‡**ï¼šæ”¯æŒç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š

### 5. æ—¥å¿—ç³»ç»Ÿ

ä½¿ç”¨ Loguru å®ç°ç»“æ„åŒ–æ—¥å¿—ï¼š

- **ç»“æ„åŒ–æ—¥å¿—**ï¼šJSON æ ¼å¼çš„æ—¥å¿—è¾“å‡º
- **è¯·æ±‚è¿½è¸ª**ï¼šæ¯ä¸ªè¯·æ±‚éƒ½æœ‰å”¯ä¸€çš„è¯·æ±‚ ID
- **æ—¥å¿—è½®è½¬**ï¼šè‡ªåŠ¨æŒ‰å¤§å°å’Œæ—¶é—´è½®è½¬æ—¥å¿—æ–‡ä»¶
- **é”™è¯¯æ—¥å¿—**ï¼šé”™è¯¯æ—¥å¿—å•ç‹¬è®°å½•
- **å½©è‰²è¾“å‡º**ï¼šæ§åˆ¶å°è¾“å‡ºæ”¯æŒå½©è‰²æ˜¾ç¤º

### 6. ç”¨æˆ·ä¸ªæ€§åŒ–è®¾ç½®

é€šè¿‡ `user_settings` è¡¨ä¸ºæ¯ä½ç”¨æˆ·ä¿å­˜åå¥½ï¼š

- **é»˜è®¤ LLM å‚æ•°**ï¼šè®°å½•é»˜è®¤æ¨¡å‹ã€æ¸©åº¦å’Œæœ€å¤§ Token
- **ç•Œé¢åå¥½**ï¼šä¸»é¢˜ï¼ˆlight/darkï¼‰ä¸è¯­è¨€ï¼ˆzh-CN/en ç­‰ï¼‰éšæ—¶åˆ‡æ¢
- **æ‰©å±•å­—æ®µ**ï¼š`settings` JSON å¯å­˜å‚¨æ›´å¤šè‡ªå®šä¹‰é…ç½®
- **API é€šè·¯**ï¼š`GET/PUT /api/v1/users/settings` ç§’çº§è¯»å†™å½“å‰ç”¨æˆ·é…ç½®

## ğŸ“š API ç«¯ç‚¹æ¦‚è§ˆ

### è®¤è¯ç›¸å…³

- `POST /api/v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `GET /api/v1/auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `PUT /api/v1/auth/me` - æ›´æ–°å½“å‰ç”¨æˆ·ä¿¡æ¯
- `POST /api/v1/auth/reset-password` - ä¿®æ”¹å¯†ç 

### ç”¨æˆ·ç®¡ç†ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰

- `GET /api/v1/users` - è·å–ç”¨æˆ·åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰
- `GET /api/v1/users/{user_id}` - è·å–ç”¨æˆ·è¯¦æƒ…
- `POST /api/v1/users` - åˆ›å»ºç”¨æˆ·
- `PUT /api/v1/users/{user_id}` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `DELETE /api/v1/users/{user_id}` - åˆ é™¤ç”¨æˆ·

### ç”¨æˆ·ä¸ªæ€§åŒ–è®¾ç½®

- `GET /api/v1/users/settings` - è·å–ç”¨æˆ·è®¾ç½®
- `PUT /api/v1/users/settings` - æ›´æ–°é»˜è®¤æ¨¡å‹ã€ä¸»é¢˜ã€è¯­è¨€ç­‰åå¥½

### å¯¹è¯ç³»ç»Ÿ

- `POST /api/v1/chat` - å‘é€æ¶ˆæ¯ï¼ˆéæµå¼ï¼‰
- `POST /api/v1/chat/stream` - å‘é€æ¶ˆæ¯ï¼ˆæµå¼ SSEï¼‰
- `POST /api/v1/conversations` - åˆ›å»ºä¼šè¯
- `GET /api/v1/conversations` - è·å–ä¼šè¯åˆ—è¡¨
- `GET /api/v1/conversations/{thread_id}` - è·å–ä¼šè¯è¯¦æƒ…
- `PATCH /api/v1/conversations/{thread_id}` - æ›´æ–°ä¼šè¯
- `DELETE /api/v1/conversations/{thread_id}` - åˆ é™¤ä¼šè¯
- `POST /api/v1/conversations/{thread_id}/reset` - é‡ç½®ä¼šè¯
- `GET /api/v1/conversations/{thread_id}/messages` - è·å–æ¶ˆæ¯å†å²
- `POST /api/v1/conversations/{thread_id}/messages/{message_id}/regenerate` - é‡æ–°ç”ŸæˆåŠ©æ‰‹æ¶ˆæ¯
- `GET /api/v1/conversations/{thread_id}/state` - è·å–ä¼šè¯çŠ¶æ€
- `GET /api/v1/conversations/{thread_id}/checkpoints` - è·å–æ£€æŸ¥ç‚¹å†å²
- `GET /api/v1/conversations/{thread_id}/export` - å¯¼å‡ºä¼šè¯
- `POST /api/v1/conversations/import` - å¯¼å…¥ä¼šè¯
- `POST /api/v1/conversations/search` - æœç´¢ä¼šè¯å’Œæ¶ˆæ¯
- `GET /api/v1/conversations/users/stats` - è·å–ç”¨æˆ·ç»Ÿè®¡

### ç³»ç»Ÿç®¡ç†

- `GET /health` - å¥åº·æ£€æŸ¥
- `GET /` - æ ¹è·¯å¾„
- `GET /docs` - Swagger UI
- `GET /redoc` - ReDoc æ–‡æ¡£

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

é¡¹ç›®ä½¿ç”¨ Makefile ç®€åŒ–å¸¸ç”¨æ“ä½œï¼š

```bash
make help          # æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
make install       # å®‰è£…ä¾èµ–
make dev           # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
make test          # è¿è¡Œæµ‹è¯•
make lint          # ä»£ç æ£€æŸ¥
make lint-fix      # ä»£ç æ£€æŸ¥å¹¶è‡ªåŠ¨ä¿®å¤
make format        # æ ¼å¼åŒ–ä»£ç 
make type-check    # ç±»å‹æ£€æŸ¥
make db-migrate msg="æè¿°"  # åˆ›å»ºæ•°æ®åº“è¿ç§»
make db-upgrade    # å‡çº§æ•°æ®åº“
make db-downgrade  # é™çº§æ•°æ®åº“
make clean         # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
```

## ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
make test

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/integration/test_chat_route.py -v

# è¿è¡Œæµ‹è¯•å¹¶æ˜¾ç¤ºè¦†ç›–ç‡
pytest --cov=app --cov-report=html
```

## ğŸ“– æ–‡æ¡£

- [AsyncSqliteSaver å·¥ä½œåŸç†](./docs/AsyncSqliteSaverå·¥ä½œåŸç†.md) - è¯¦ç»†è¯´æ˜ LangGraph æ£€æŸ¥ç‚¹æœºåˆ¶
- [API æ–‡æ¡£](http://localhost:8000/docs) - å¯åŠ¨æœåŠ¡åè®¿é—®äº¤äº’å¼ API æ–‡æ¡£
- [ReDoc](http://localhost:8000/redoc) - æ›¿ä»£çš„ API æ–‡æ¡£æ ¼å¼

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„ API ç«¯ç‚¹

1. åœ¨ `app/models/` åˆ›å»ºæ•°æ®åº“æ¨¡å‹
2. åœ¨ `app/schemas/` åˆ›å»º Pydantic æ¨¡å‹
3. åœ¨ `app/api/` åˆ›å»ºè·¯ç”±æ–‡ä»¶
4. åœ¨ `app/main.py` æ³¨å†Œè·¯ç”±
5. åˆ›å»ºæ•°æ®åº“è¿ç§»ï¼š`make db-migrate msg="æ·»åŠ æ–°è¡¨"`
6. ç¼–å†™æµ‹è¯•ç”¨ä¾‹

### é›†æˆæ–°çš„ LLM æä¾›å•†

1. åœ¨ `app/sample_agent.py` ä¸­è°ƒæ•´ `get_agent()`ï¼ˆæˆ–è‡ªå®šä¹‰æ–°çš„ Agent å›¾ï¼‰
2. æ·»åŠ /ä¿®æ”¹å¯¹åº”çš„ç¯å¢ƒå˜é‡ï¼Œå¦‚ API Keyã€Base URLã€æ¨¡å‹åç§°
3. æ›´æ–° `pyproject.toml` ä»¥æ·»åŠ æ‰€éœ€ SDK ä¾èµ–

### è‡ªå®šä¹‰ LangGraph æµç¨‹

ç¼–è¾‘ `app/core/graph.py` ä¸­çš„ `create_graph()` å‡½æ•°ï¼Œå®šä¹‰ä½ çš„å¯¹è¯æµç¨‹ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£åŒ–çš„ Python Web æ¡†æ¶
- [LangGraph](https://langchain-ai.github.io/langgraph/) - å¯¹è¯æµç¨‹ç¼–æ’æ¡†æ¶
- [SQLAlchemy](https://www.sqlalchemy.org/) - Python SQL å·¥å…·åŒ…å’Œ ORM
- [Pydantic](https://docs.pydantic.dev/) - æ•°æ®éªŒè¯åº“

---

**Happy Coding! ğŸš€**

é¡¹ç›®åœ°å€ï¼š[https://github.com/zhajiahe/fastapi-template](https://github.com/zhajiahe/fastapi-template)
